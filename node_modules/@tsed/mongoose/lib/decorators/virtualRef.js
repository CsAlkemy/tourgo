"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("@tsed/common");
const core_1 = require("@tsed/core");
const constants_1 = require("../constants");
function VirtualRef(options, foreignField) {
    return (target, propertyKey, descriptor) => {
        let schema, type;
        if (typeof options === "object") {
            type = options.type;
            schema = {
                ref: typeof type === "string" ? type : core_1.Store.from(type).get(constants_1.MONGOOSE_MODEL_NAME),
                localField: options.localField || propertyKey,
                foreignField: options.foreignField,
                justOne: options.justOne || false,
                options: options.options
            };
        }
        else {
            schema = {
                ref: options,
                localField: propertyKey,
                foreignField
            };
        }
        return core_1.applyDecorators(common_1.Property({ name: schema.localField, use: type }), core_1.StoreMerge(constants_1.MONGOOSE_SCHEMA, schema))(target, propertyKey, descriptor);
    };
}
exports.VirtualRef = VirtualRef;

//# sourceMappingURL=virtualRef.js.map
